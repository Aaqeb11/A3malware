<html>
<head>
<title>Malware.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Malware.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">messagebox</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">*</span>
<span class="s0">from </span><span class="s1">tkinter.filedialog </span><span class="s0">import </span><span class="s1">askopenfilename</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">simpledialog</span>
<span class="s0">import </span><span class="s1">tkinter</span>
<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">filedialog</span>
<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">from </span><span class="s1">sklearn.model_selection </span><span class="s0">import </span><span class="s1">train_test_split</span>
<span class="s0">from </span><span class="s1">sklearn.metrics </span><span class="s0">import </span><span class="s1">accuracy_score</span>
<span class="s0">import </span><span class="s1">matplotlib.pyplot </span><span class="s0">as </span><span class="s1">plt</span>
<span class="s0">from </span><span class="s1">sklearn.naive_bayes </span><span class="s0">import </span><span class="s1">BernoulliNB</span>
<span class="s0">from </span><span class="s1">sklearn.neighbors </span><span class="s0">import </span><span class="s1">KNeighborsClassifier</span>
<span class="s0">from </span><span class="s1">sklearn.tree </span><span class="s0">import </span><span class="s1">DecisionTreeClassifier</span>
<span class="s0">from </span><span class="s1">sklearn.metrics </span><span class="s0">import </span><span class="s1">precision_score</span>
<span class="s0">from </span><span class="s1">sklearn.metrics </span><span class="s0">import </span><span class="s1">recall_score</span>
<span class="s0">from </span><span class="s1">sklearn.metrics </span><span class="s0">import </span><span class="s1">f1_score</span>
<span class="s0">from </span><span class="s1">sklearn.metrics </span><span class="s0">import </span><span class="s1">accuracy_score</span>
<span class="s0">from </span><span class="s1">sklearn.ensemble </span><span class="s0">import </span><span class="s1">RandomForestClassifier</span>
<span class="s0">from </span><span class="s1">sklearn.linear_model </span><span class="s0">import </span><span class="s1">LogisticRegression</span>
<span class="s0">from </span><span class="s1">sklearn </span><span class="s0">import </span><span class="s1">svm</span>
<span class="s0">from </span><span class="s1">keras.models </span><span class="s0">import </span><span class="s1">Sequential</span>
<span class="s0">from </span><span class="s1">keras.layers </span><span class="s0">import </span><span class="s1">Convolution2D</span>
<span class="s0">from </span><span class="s1">keras.layers </span><span class="s0">import </span><span class="s1">MaxPooling2D</span>
<span class="s0">from </span><span class="s1">keras.layers </span><span class="s0">import </span><span class="s1">Flatten</span>
<span class="s0">from </span><span class="s1">keras.layers </span><span class="s0">import </span><span class="s1">Dense</span><span class="s0">, </span><span class="s1">Activation</span><span class="s0">, </span><span class="s1">BatchNormalization</span><span class="s0">, </span><span class="s1">Dropout</span>
<span class="s0">from </span><span class="s1">sklearn.preprocessing </span><span class="s0">import </span><span class="s1">OneHotEncoder</span>
<span class="s0">from </span><span class="s1">keras.models </span><span class="s0">import </span><span class="s1">model_from_json</span>
<span class="s2"># from keras.layers import LSTM</span>
<span class="s0">from </span><span class="s1">keras.layers.embeddings </span><span class="s0">import </span><span class="s1">Embedding</span>
<span class="s0">from </span><span class="s1">sklearn.preprocessing </span><span class="s0">import </span><span class="s1">StandardScaler</span>
<span class="s0">from </span><span class="s1">sklearn.preprocessing </span><span class="s0">import </span><span class="s1">Normalizer</span>
<span class="s0">import </span><span class="s1">keras.layers</span>
<span class="s0">from </span><span class="s1">keras.models </span><span class="s0">import </span><span class="s1">model_from_json</span>

<span class="s1">main = tkinter.Tk()</span>
<span class="s1">main.title(</span><span class="s3">&quot;Robust Intelligent Malware Detection Using Deep Learning&quot;</span><span class="s1">)</span>
<span class="s1">main.geometry(</span><span class="s3">&quot;1300x1200&quot;</span><span class="s1">)</span>

<span class="s1">malware_name = [</span><span class="s3">'Dialer Adialer.C'</span><span class="s0">, </span><span class="s3">'Backdoor Agent.FYI'</span><span class="s0">, </span><span class="s3">'Worm Allaple.A'</span><span class="s0">, </span><span class="s3">'Worm Allaple.L'</span><span class="s0">, </span><span class="s3">'Trojan Alueron.gen'</span><span class="s0">,</span>
                <span class="s3">'Worm:AutoIT Autorun.K'</span><span class="s0">,</span>
                <span class="s3">'Trojan C2Lop.P'</span><span class="s0">, </span><span class="s3">'Trojan C2Lop.gen'</span><span class="s0">, </span><span class="s3">'Dialer Dialplatform.B'</span><span class="s0">, </span><span class="s3">'Trojan Downloader Dontovo.A'</span><span class="s0">,</span>
                <span class="s3">'Rogue Fakerean'</span><span class="s0">, </span><span class="s3">'Dialer Instantaccess'</span><span class="s0">,</span>
                <span class="s3">'PWS Lolyda.AA 1'</span><span class="s0">, </span><span class="s3">'PWS Lolyda.AA 2'</span><span class="s0">, </span><span class="s3">'PWS Lolyda.AA 3'</span><span class="s0">, </span><span class="s3">'PWS Lolyda.AT'</span><span class="s0">, </span><span class="s3">'Trojan Malex.gen'</span><span class="s0">,</span>
                <span class="s3">'Trojan Downloader Obfuscator.AD'</span><span class="s0">,</span>
                <span class="s3">'Backdoor Rbot!gen'</span><span class="s0">, </span><span class="s3">'Trojan Skintrim.N'</span><span class="s0">, </span><span class="s3">'Trojan Downloader Swizzor.gen!E'</span><span class="s0">,</span>
                <span class="s3">'Trojan Downloader Swizzor.gen!I'</span><span class="s0">, </span><span class="s3">'Worm VB.AT'</span><span class="s0">,</span>
                <span class="s3">'Trojan Downloader Wintrim.BX'</span><span class="s0">, </span><span class="s3">'Worm Yuner.A'</span><span class="s1">]</span>

<span class="s0">global </span><span class="s1">filename</span>
<span class="s0">global </span><span class="s1">knn_precision</span><span class="s0">, </span><span class="s1">nb_precision</span><span class="s0">, </span><span class="s1">tree_precision</span><span class="s0">, </span><span class="s1">svm_precision</span><span class="s0">, </span><span class="s1">random_precision</span><span class="s0">, </span><span class="s1">logistic_precision</span><span class="s0">, </span><span class="s1">cnn_precision</span><span class="s0">, </span><span class="s1">lstm_precision</span>
<span class="s0">global </span><span class="s1">knn_recall</span><span class="s0">, </span><span class="s1">nb_recall</span><span class="s0">, </span><span class="s1">tree_recall</span><span class="s0">, </span><span class="s1">svm_recall</span><span class="s0">, </span><span class="s1">random_recall</span><span class="s0">, </span><span class="s1">logistic_recall</span><span class="s0">, </span><span class="s1">cnn_recall</span><span class="s0">, </span><span class="s1">lstm_recall</span>
<span class="s0">global </span><span class="s1">knn_fmeasure</span><span class="s0">, </span><span class="s1">nb_fmeasure</span><span class="s0">, </span><span class="s1">tree_fmeasure</span><span class="s0">, </span><span class="s1">svm_fmeasure</span><span class="s0">, </span><span class="s1">random_fmeasure</span><span class="s0">, </span><span class="s1">logistic_fmeasure</span><span class="s0">, </span><span class="s1">cnn_fmeasure</span><span class="s0">, </span><span class="s1">lstm_fmeasure</span>
<span class="s0">global </span><span class="s1">knn_acc</span><span class="s0">, </span><span class="s1">nb_acc</span><span class="s0">, </span><span class="s1">tree_acc</span><span class="s0">, </span><span class="s1">svm_acc</span><span class="s0">, </span><span class="s1">random_acc</span><span class="s0">, </span><span class="s1">logistic_acc</span><span class="s0">, </span><span class="s1">cnn_acc</span><span class="s0">, </span><span class="s1">lstm_acc</span>

<span class="s0">global </span><span class="s1">classifier</span>
<span class="s0">global </span><span class="s1">X_train</span><span class="s0">, </span><span class="s1">X_test</span><span class="s0">, </span><span class="s1">y_train</span><span class="s0">, </span><span class="s1">y_test</span>


<span class="s0">def </span><span class="s1">load_lstmcnn(dataset</span><span class="s0">, </span><span class="s1">standardize=</span><span class="s0">True</span><span class="s1">):</span>
    <span class="s1">features = dataset[</span><span class="s3">'arr'</span><span class="s1">][:</span><span class="s0">, </span><span class="s4">0</span><span class="s1">]</span>
    <span class="s1">features = np.array([feature </span><span class="s0">for </span><span class="s1">feature </span><span class="s0">in </span><span class="s1">features])</span>
    <span class="s1">features = np.reshape(features</span><span class="s0">, </span><span class="s1">(features.shape[</span><span class="s4">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">features.shape[</span><span class="s4">1</span><span class="s1">] * features.shape[</span><span class="s4">2</span><span class="s1">]))</span>
    <span class="s0">if </span><span class="s1">standardize:</span>
        <span class="s1">features = StandardScaler().fit_transform(features)</span>

    <span class="s1">labels = dataset[</span><span class="s3">'arr'</span><span class="s1">][:</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]</span>
    <span class="s1">labels = np.array([label </span><span class="s0">for </span><span class="s1">label </span><span class="s0">in </span><span class="s1">labels])</span>

    <span class="s1">print(labels.shape)</span>
    <span class="s1">print(features.shape)</span>

    <span class="s0">return </span><span class="s1">features</span><span class="s0">, </span><span class="s1">labels</span>


<span class="s0">def </span><span class="s1">load_data(dataset</span><span class="s0">, </span><span class="s1">standardize=</span><span class="s0">True</span><span class="s1">):</span>
    <span class="s1">features = dataset[</span><span class="s3">'arr'</span><span class="s1">][:</span><span class="s0">, </span><span class="s4">0</span><span class="s1">]</span>
    <span class="s1">features = np.array([feature </span><span class="s0">for </span><span class="s1">feature </span><span class="s0">in </span><span class="s1">features])</span>
    <span class="s1">features = np.reshape(features</span><span class="s0">, </span><span class="s1">(features.shape[</span><span class="s4">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">features.shape[</span><span class="s4">1</span><span class="s1">] * features.shape[</span><span class="s4">2</span><span class="s1">]))</span>
    <span class="s0">if </span><span class="s1">standardize:</span>
        <span class="s1">features = StandardScaler().fit_transform(features)</span>

    <span class="s1">labels = dataset[</span><span class="s3">'arr'</span><span class="s1">][:</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]</span>
    <span class="s1">labels = np.array([label </span><span class="s0">for </span><span class="s1">label </span><span class="s0">in </span><span class="s1">labels])</span>

    <span class="s1">feature = []</span>
    <span class="s1">label = []</span>
    <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s0">, </span><span class="s4">4000</span><span class="s1">):</span>
        <span class="s1">feature.append(features[i])</span>
        <span class="s1">label.append(labels[i])</span>

    <span class="s1">feature = np.asarray(feature)</span>
    <span class="s1">label = np.asarray(label)</span>
    <span class="s1">print(labels.shape)</span>
    <span class="s1">print(features.shape)</span>
    <span class="s1">print(label.shape)</span>
    <span class="s1">print(feature.shape)</span>
    <span class="s0">return </span><span class="s1">feature</span><span class="s0">, </span><span class="s1">label</span>


<span class="s0">def </span><span class="s1">upload():</span>
    <span class="s0">global </span><span class="s1">filename</span>
    <span class="s1">filename = filedialog.askopenfilename(initialdir=</span><span class="s3">&quot;dataset&quot;</span><span class="s1">)</span>
    <span class="s1">pathlabel.config(text=filename)</span>
    <span class="s1">text.delete(</span><span class="s3">'1.0'</span><span class="s0">, </span><span class="s1">END)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">'MalImg dataset loaded</span><span class="s0">\n</span><span class="s3">'</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">prediction(X_test</span><span class="s0">, </span><span class="s1">cls):</span>
    <span class="s1">y_pred = cls.predict(X_test)</span>
    <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(len(X_test)):</span>
        <span class="s1">print(</span><span class="s3">&quot;X=%s, Predicted=%s&quot; </span><span class="s1">% (X_test[i]</span><span class="s0">, </span><span class="s1">y_pred[i]))</span>
    <span class="s0">return </span><span class="s1">y_pred</span>


<span class="s0">def </span><span class="s1">naivebayes():</span>
    <span class="s0">global </span><span class="s1">nb_precision</span>
    <span class="s0">global </span><span class="s1">nb_recall</span>
    <span class="s0">global </span><span class="s1">nb_fmeasure</span>
    <span class="s0">global </span><span class="s1">nb_acc</span>
    <span class="s1">text.delete(</span><span class="s3">'1.0'</span><span class="s0">, </span><span class="s1">END)</span>
    <span class="s1">data</span><span class="s0">, </span><span class="s1">labels = load_data(np.load(filename</span><span class="s0">, </span><span class="s1">allow_pickle=</span><span class="s0">True</span><span class="s1">))</span>
    <span class="s1">X_train</span><span class="s0">, </span><span class="s1">X_test</span><span class="s0">, </span><span class="s1">y_train</span><span class="s0">, </span><span class="s1">y_test = train_test_split(data</span><span class="s0">, </span><span class="s1">labels</span><span class="s0">, </span><span class="s1">test_size=</span><span class="s4">0.2</span><span class="s1">)</span>
    <span class="s1">scaler = Normalizer().fit(X_train)</span>
    <span class="s1">X_train = scaler.transform(X_train)</span>
    <span class="s1">scaler = Normalizer().fit(X_test)</span>
    <span class="s1">X_test = scaler.transform(X_test)</span>
    <span class="s1">cls = BernoulliNB(binarize=</span><span class="s4">0.0</span><span class="s1">)</span>
    <span class="s1">cls.fit(X_train</span><span class="s0">, </span><span class="s1">y_train)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Naive Bayes Prediction Results</span><span class="s0">\n\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">prediction_data = prediction(X_test</span><span class="s0">, </span><span class="s1">cls)</span>
    <span class="s1">nb_precision = precision_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">nb_recall = recall_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">nb_fmeasure = f1_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">nb_acc = accuracy_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data) * </span><span class="s4">100</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Naive Bayes Precision : &quot; </span><span class="s1">+ str(nb_precision) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Naive Bayes Recall : &quot; </span><span class="s1">+ str(nb_recall) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Naive Bayes FMeasure : &quot; </span><span class="s1">+ str(nb_fmeasure) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Naive Bayes Accuracy : &quot; </span><span class="s1">+ str(nb_acc) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">decisionTree():</span>
    <span class="s1">text.delete(</span><span class="s3">'1.0'</span><span class="s0">, </span><span class="s1">END)</span>
    <span class="s0">global </span><span class="s1">tree_acc</span>
    <span class="s0">global </span><span class="s1">tree_precision</span>
    <span class="s0">global </span><span class="s1">tree_recall</span>
    <span class="s0">global </span><span class="s1">tree_fmeasure</span>
    <span class="s1">rfc = DecisionTreeClassifier(criterion=</span><span class="s3">&quot;entropy&quot;</span><span class="s0">, </span><span class="s1">splitter=</span><span class="s3">&quot;random&quot;</span><span class="s0">, </span><span class="s1">max_depth=</span><span class="s4">20</span><span class="s0">, </span><span class="s1">min_samples_split=</span><span class="s4">50</span><span class="s0">,</span>
                                 <span class="s1">min_samples_leaf=</span><span class="s4">20</span><span class="s0">, </span><span class="s1">max_features=</span><span class="s4">5</span><span class="s1">)</span>
    <span class="s1">rfc.fit(X_train</span><span class="s0">, </span><span class="s1">y_train)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Decision Tree Prediction Results</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">prediction_data = prediction(X_test</span><span class="s0">, </span><span class="s1">rfc)</span>
    <span class="s1">tree_precision = precision_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">tree_recall = recall_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">tree_fmeasure = f1_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">tree_acc = accuracy_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data) * </span><span class="s4">100</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Decision Tree Precision : &quot; </span><span class="s1">+ str(tree_precision) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Decision Tree Recall : &quot; </span><span class="s1">+ str(tree_recall) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Decision Tree FMeasure : &quot; </span><span class="s1">+ str(tree_fmeasure) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Decision Tree Accuracy : &quot; </span><span class="s1">+ str(tree_acc) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">logisticRegression():</span>
    <span class="s1">text.delete(</span><span class="s3">'1.0'</span><span class="s0">, </span><span class="s1">END)</span>
    <span class="s0">global </span><span class="s1">logistic_acc</span>
    <span class="s0">global </span><span class="s1">logistic_precision</span>
    <span class="s0">global </span><span class="s1">logistic_recall</span>
    <span class="s0">global </span><span class="s1">logistic_fmeasure</span>
    <span class="s1">rfc = LogisticRegression(penalty=</span><span class="s3">'l2'</span><span class="s0">, </span><span class="s1">tol=</span><span class="s4">0.002</span><span class="s0">, </span><span class="s1">C=</span><span class="s4">2.0</span><span class="s1">)</span>
    <span class="s1">rfc.fit(X_train</span><span class="s0">, </span><span class="s1">y_train)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Logistic Regression Prediction Results</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">prediction_data = prediction(X_test</span><span class="s0">, </span><span class="s1">rfc)</span>
    <span class="s1">logistic_precision = precision_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">logistic_recall = recall_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">logistic_fmeasure = f1_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">logistic_acc = accuracy_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data) * </span><span class="s4">100</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Logistic Regression Precision : &quot; </span><span class="s1">+ str(logistic_precision) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Logistic Regression Recall : &quot; </span><span class="s1">+ str(logistic_recall) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Logistic Regression FMeasure : &quot; </span><span class="s1">+ str(logistic_fmeasure) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;Logistic Regression Accuracy : &quot; </span><span class="s1">+ str(logistic_acc) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">SVM():</span>
    <span class="s1">text.delete(</span><span class="s3">'1.0'</span><span class="s0">, </span><span class="s1">END)</span>
    <span class="s0">global </span><span class="s1">svm_acc</span>
    <span class="s0">global </span><span class="s1">svm_precision</span>
    <span class="s0">global </span><span class="s1">svm_recall</span>
    <span class="s0">global </span><span class="s1">svm_fmeasure</span>
    <span class="s0">global </span><span class="s1">X_train</span><span class="s0">, </span><span class="s1">X_test</span><span class="s0">, </span><span class="s1">y_train</span><span class="s0">, </span><span class="s1">y_test</span>
    <span class="s1">data</span><span class="s0">, </span><span class="s1">labels = load_data(np.load(filename</span><span class="s0">, </span><span class="s1">allow_pickle=</span><span class="s0">True</span><span class="s1">))</span>
    <span class="s1">X_train</span><span class="s0">, </span><span class="s1">X_test</span><span class="s0">, </span><span class="s1">y_train</span><span class="s0">, </span><span class="s1">y_test = train_test_split(data</span><span class="s0">, </span><span class="s1">labels</span><span class="s0">, </span><span class="s1">test_size=</span><span class="s4">0.2</span><span class="s1">)</span>
    <span class="s1">print(</span><span class="s3">&quot;hello&quot;</span><span class="s1">)</span>
    <span class="s1">rfc = svm.SVC(C=</span><span class="s4">2.0</span><span class="s0">, </span><span class="s1">gamma=</span><span class="s3">'scale'</span><span class="s0">, </span><span class="s1">kernel=</span><span class="s3">'rbf'</span><span class="s0">, </span><span class="s1">random_state=</span><span class="s4">2</span><span class="s1">)</span>
    <span class="s1">rfc.fit(X_train</span><span class="s0">, </span><span class="s1">y_train)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;SVM Prediction Results</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">prediction_data = prediction(X_test</span><span class="s0">, </span><span class="s1">rfc)</span>
    <span class="s1">svm_precision = precision_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">svm_recall = recall_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">svm_fmeasure = f1_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">svm_acc = accuracy_score(y_test</span><span class="s0">, </span><span class="s1">prediction_data) * </span><span class="s4">100</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;SVM Precision : &quot; </span><span class="s1">+ str(svm_precision) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;SVM Recall : &quot; </span><span class="s1">+ str(svm_recall) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;SVM FMeasure : &quot; </span><span class="s1">+ str(svm_fmeasure) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;SVM Accuracy : &quot; </span><span class="s1">+ str(svm_acc) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">CNN():</span>
    <span class="s0">global </span><span class="s1">cnn_acc</span>
    <span class="s0">global </span><span class="s1">cnn_precision</span>
    <span class="s0">global </span><span class="s1">cnn_recall</span>
    <span class="s0">global </span><span class="s1">cnn_fmeasure</span>
    <span class="s1">text.delete(</span><span class="s3">'1.0'</span><span class="s0">, </span><span class="s1">END)</span>

    <span class="s1">data</span><span class="s0">, </span><span class="s1">labels = load_lstmcnn(np.load(filename</span><span class="s0">, </span><span class="s1">allow_pickle=</span><span class="s0">True</span><span class="s1">))</span>
    <span class="s1">labels = labels.reshape((</span><span class="s4">9339</span><span class="s0">, </span><span class="s4">1</span><span class="s1">))</span>
    <span class="s1">print(labels)</span>
    <span class="s1">data = data.reshape((</span><span class="s4">9339</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">32</span><span class="s1">))</span>
    <span class="s1">X_train1</span><span class="s0">, </span><span class="s1">X_test1</span><span class="s0">, </span><span class="s1">y_train1</span><span class="s0">, </span><span class="s1">y_test1 = train_test_split(data</span><span class="s0">, </span><span class="s1">labels</span><span class="s0">, </span><span class="s1">test_size=</span><span class="s4">0.101</span><span class="s1">)</span>
    <span class="s1">enc = OneHotEncoder()</span>
    <span class="s1">enc.fit(y_train1)</span>
    <span class="s1">print(y_train1.shape)</span>
    <span class="s1">y_train1 = enc.transform(y_train1)</span>
    <span class="s1">y_test1 = enc.transform(y_test1)</span>
    <span class="s2"># rehsaping traing</span>
    <span class="s1">print(</span><span class="s3">&quot;X_train.shape before  = &quot;</span><span class="s0">, </span><span class="s1">X_train1.shape)</span>
    <span class="s1">X_train1 = X_train1.reshape((</span><span class="s4">8395</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">1</span><span class="s1">))</span>
    <span class="s1">print(</span><span class="s3">&quot;X_train.shape after  = &quot;</span><span class="s0">, </span><span class="s1">X_train1.shape)</span>
    <span class="s1">print(</span><span class="s3">&quot;y_train.shape  = &quot;</span><span class="s0">, </span><span class="s1">y_train1.shape)</span>
    <span class="s2"># rehsaping testing</span>
    <span class="s1">print(</span><span class="s3">&quot;X_test.shape before  = &quot;</span><span class="s0">, </span><span class="s1">X_test1.shape)</span>
    <span class="s1">X_test1 = X_test1.reshape((</span><span class="s4">944</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">1</span><span class="s1">))</span>
    <span class="s1">print(</span><span class="s3">&quot;X_test.shape after  = &quot;</span><span class="s0">, </span><span class="s1">X_test1.shape)</span>
    <span class="s1">print(</span><span class="s3">&quot;y_test.shape  = &quot;</span><span class="s0">, </span><span class="s1">y_test1.shape)</span>

    <span class="s1">classifier = Sequential()</span>
    <span class="s1">classifier.add(Convolution2D(</span><span class="s4">32</span><span class="s0">, </span><span class="s1">(</span><span class="s4">3</span><span class="s0">, </span><span class="s4">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">border_mode=</span><span class="s3">'valid'</span><span class="s0">, </span><span class="s1">input_shape=(</span><span class="s4">32</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)))</span>
    <span class="s1">classifier.add(BatchNormalization())</span>
    <span class="s1">classifier.add(Activation(</span><span class="s3">&quot;relu&quot;</span><span class="s1">))</span>
    <span class="s1">classifier.add(Convolution2D(</span><span class="s4">32</span><span class="s0">, </span><span class="s1">(</span><span class="s4">3</span><span class="s0">, </span><span class="s4">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">border_mode=</span><span class="s3">'valid'</span><span class="s1">))</span>
    <span class="s1">classifier.add(BatchNormalization())</span>
    <span class="s1">classifier.add(Activation(</span><span class="s3">&quot;relu&quot;</span><span class="s1">))</span>
    <span class="s1">classifier.add(MaxPooling2D(pool_size=(</span><span class="s4">2</span><span class="s0">, </span><span class="s4">2</span><span class="s1">)))</span>
    <span class="s1">classifier.add(Flatten())</span>
    <span class="s1">classifier.add(Dense(</span><span class="s4">128</span><span class="s1">))</span>
    <span class="s1">classifier.add(BatchNormalization())</span>
    <span class="s1">classifier.add(Activation(</span><span class="s3">&quot;relu&quot;</span><span class="s1">))</span>
    <span class="s1">classifier.add(Dense(</span><span class="s4">25</span><span class="s1">))</span>
    <span class="s1">classifier.add(BatchNormalization())</span>
    <span class="s1">classifier.add(Activation(</span><span class="s3">&quot;softmax&quot;</span><span class="s1">))</span>
    <span class="s1">classifier.compile(optimizer=</span><span class="s3">'adam'</span><span class="s0">, </span><span class="s1">loss=</span><span class="s3">'categorical_crossentropy'</span><span class="s0">, </span><span class="s1">metrics=[</span><span class="s3">'accuracy'</span><span class="s1">])</span>
    <span class="s1">classifier.fit(X_train1</span><span class="s0">, </span><span class="s1">y_train1</span><span class="s0">, </span><span class="s1">epochs=</span><span class="s4">10</span><span class="s0">, </span><span class="s1">batch_size=</span><span class="s4">64</span><span class="s1">)</span>

    <span class="s1">prediction_data = classifier.predict(X_test1)</span>
    <span class="s1">prediction_data = np.argmax(prediction_data</span><span class="s0">, </span><span class="s1">axis=</span><span class="s4">1</span><span class="s1">)</span>
    <span class="s1">y_test1 = np.argmax(y_test1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s4">1</span><span class="s1">)</span>
    <span class="s1">cnn_precision = precision_score(y_test1</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">cnn_recall = recall_score(y_test1</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">cnn_fmeasure = f1_score(y_test1</span><span class="s0">, </span><span class="s1">prediction_data</span><span class="s0">, </span><span class="s1">average=</span><span class="s3">'micro'</span><span class="s1">) * </span><span class="s4">100</span>
    <span class="s1">cnn_acc = accuracy_score(y_test1</span><span class="s0">, </span><span class="s1">prediction_data) * </span><span class="s4">100</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;CNN Prediction Results</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;CNN Precision : &quot; </span><span class="s1">+ str(cnn_precision) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;CNN Recall : &quot; </span><span class="s1">+ str(cnn_recall) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;CNN FMeasure : &quot; </span><span class="s1">+ str(cnn_fmeasure) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">&quot;CNN Accuracy : &quot; </span><span class="s1">+ str(cnn_acc) + </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">predict():</span>
    <span class="s1">filename = filedialog.askopenfilename(initialdir=</span><span class="s3">&quot;images&quot;</span><span class="s1">)</span>
    <span class="s1">text.delete(</span><span class="s3">'1.0'</span><span class="s0">, </span><span class="s1">END)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s1">filename + </span><span class="s3">&quot; loaded</span><span class="s0">\n\n</span><span class="s3">&quot;</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">open(</span><span class="s3">'model.json'</span><span class="s0">, </span><span class="s3">&quot;r&quot;</span><span class="s1">) </span><span class="s0">as </span><span class="s1">json_file:</span>
        <span class="s1">loaded_model_json = json_file.read()</span>
        <span class="s1">loaded_model = model_from_json(loaded_model_json)</span>
    <span class="s1">loaded_model.load_weights(</span><span class="s3">&quot;model_weights.h5&quot;</span><span class="s1">)</span>
    <span class="s1">loaded_model._make_predict_function()</span>
    <span class="s1">print(loaded_model.summary())</span>

    <span class="s1">img = np.load(filename)</span>
    <span class="s1">im2arr = img.reshape(</span><span class="s4">1</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">32</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)</span>
    <span class="s1">preds = loaded_model.predict(im2arr)</span>
    <span class="s1">print(str(preds) + </span><span class="s3">&quot; &quot; </span><span class="s1">+ str(np.argmax(preds)))</span>
    <span class="s1">predict = np.argmax(preds)</span>
    <span class="s1">text.insert(END</span><span class="s0">, </span><span class="s3">'Uploaded file contains malware from family : ' </span><span class="s1">+ malware_name[predict])</span>


<span class="s0">def </span><span class="s1">precisionGraph():</span>
    <span class="s1">height = [ nb_precision</span><span class="s0">, </span><span class="s1">tree_precision</span><span class="s0">, </span><span class="s1">svm_precision</span><span class="s0">, </span><span class="s1">logistic_precision</span><span class="s0">,</span>
              <span class="s1">cnn_precision]</span>
    <span class="s1">bars = (</span>
    <span class="s3">'NB Precision'</span><span class="s0">, </span><span class="s3">'DT Precision'</span><span class="s0">, </span><span class="s3">'SVM Precision'</span><span class="s0">,  </span><span class="s3">'LR Precision'</span><span class="s0">, </span><span class="s3">'CNN Precision'</span><span class="s1">)</span>
    <span class="s1">y_pos = np.arange(len(bars))</span>
    <span class="s1">plt.bar(y_pos</span><span class="s0">, </span><span class="s1">height)</span>
    <span class="s1">plt.xticks(y_pos</span><span class="s0">, </span><span class="s1">bars)</span>
    <span class="s1">plt.show()</span>


<span class="s0">def </span><span class="s1">recallGraph():</span>
    <span class="s1">height = [ nb_recall</span><span class="s0">, </span><span class="s1">tree_recall</span><span class="s0">, </span><span class="s1">svm_recall</span><span class="s0">, </span><span class="s1">logistic_recall</span><span class="s0">, </span><span class="s1">cnn_recall]</span>
    <span class="s1">bars = ( </span><span class="s3">'NB Recall'</span><span class="s0">, </span><span class="s3">'DT Recall'</span><span class="s0">, </span><span class="s3">'SVM Recall'</span><span class="s0">, </span><span class="s3">'LR Recall'</span><span class="s0">, </span><span class="s3">'CNN Recall'</span><span class="s1">)</span>
    <span class="s1">y_pos = np.arange(len(bars))</span>
    <span class="s1">plt.bar(y_pos</span><span class="s0">, </span><span class="s1">height)</span>
    <span class="s1">plt.xticks(y_pos</span><span class="s0">, </span><span class="s1">bars)</span>
    <span class="s1">plt.show()</span>


<span class="s0">def </span><span class="s1">fscoreGraph():</span>
    <span class="s1">height = [ nb_fmeasure</span><span class="s0">, </span><span class="s1">tree_fmeasure</span><span class="s0">, </span><span class="s1">svm_fmeasure</span><span class="s0">, </span><span class="s1">logistic_fmeasure</span><span class="s0">, </span><span class="s1">cnn_fmeasure]</span>
    <span class="s1">bars = ( </span><span class="s3">'NB FScore'</span><span class="s0">, </span><span class="s3">'DT FScore'</span><span class="s0">, </span><span class="s3">'SVM FScore'</span><span class="s0">, </span><span class="s3">'LR FScore'</span><span class="s0">, </span><span class="s3">'CNN FScore'</span><span class="s1">)</span>
    <span class="s1">y_pos = np.arange(len(bars))</span>
    <span class="s1">plt.bar(y_pos</span><span class="s0">, </span><span class="s1">height)</span>
    <span class="s1">plt.xticks(y_pos</span><span class="s0">, </span><span class="s1">bars)</span>
    <span class="s1">plt.show()</span>


<span class="s0">def </span><span class="s1">accuracyGraph():</span>
    <span class="s1">height = [ nb_acc</span><span class="s0">, </span><span class="s1">tree_acc</span><span class="s0">, </span><span class="s1">svm_acc</span><span class="s0">, </span><span class="s1">logistic_acc</span><span class="s0">, </span><span class="s1">cnn_acc]</span>
    <span class="s1">bars = ( </span><span class="s3">'NB ACC'</span><span class="s0">, </span><span class="s3">'DT ACC'</span><span class="s0">, </span><span class="s3">'SVM ACC'</span><span class="s0">,  </span><span class="s3">'LR ACC'</span><span class="s0">, </span><span class="s3">'CNN ACC'</span><span class="s1">)</span>
    <span class="s1">y_pos = np.arange(len(bars))</span>
    <span class="s1">plt.bar(y_pos</span><span class="s0">, </span><span class="s1">height)</span>
    <span class="s1">plt.xticks(y_pos</span><span class="s0">, </span><span class="s1">bars)</span>
    <span class="s1">plt.show()</span>


<span class="s1">font = (</span><span class="s3">'times'</span><span class="s0">, </span><span class="s4">18</span><span class="s0">, </span><span class="s3">'bold'</span><span class="s1">)</span>
<span class="s1">title = Label(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">'Robust Intelligent Malware Detection Using Deep Learning'</span><span class="s1">)</span>
<span class="s1">title.config(bg=</span><span class="s3">'honeydew4'</span><span class="s0">, </span><span class="s1">fg=</span><span class="s3">'white'</span><span class="s1">)</span>
<span class="s1">title.config(font=font)</span>
<span class="s1">title.config(height=</span><span class="s4">3</span><span class="s0">, </span><span class="s1">width=</span><span class="s4">120</span><span class="s1">)</span>
<span class="s1">title.place(x=</span><span class="s4">0</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">5</span><span class="s1">)</span>

<span class="s1">font1 = (</span><span class="s3">'times'</span><span class="s0">, </span><span class="s4">14</span><span class="s0">, </span><span class="s3">'bold'</span><span class="s1">)</span>
<span class="s1">upload = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Upload Malware MalImg Dataset&quot;</span><span class="s0">, </span><span class="s1">command=upload)</span>
<span class="s1">upload.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">100</span><span class="s1">)</span>
<span class="s1">upload.config(font=font1)</span>

<span class="s1">pathlabel = Label(main)</span>
<span class="s1">pathlabel.config(bg=</span><span class="s3">'gray87'</span><span class="s0">, </span><span class="s1">fg=</span><span class="s3">'white'</span><span class="s1">)</span>
<span class="s1">pathlabel.config(font=font1)</span>
<span class="s1">pathlabel.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">150</span><span class="s1">)</span>

<span class="s1">svmButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Run Ember SVM Algorithm&quot;</span><span class="s0">, </span><span class="s1">command=SVM)</span>
<span class="s1">svmButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">200</span><span class="s1">)</span>
<span class="s1">svmButton.config(font=font1)</span>

<span class="s1">nbButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Run Ember Naive Bayes Algorithm&quot;</span><span class="s0">, </span><span class="s1">command=naivebayes)</span>
<span class="s1">nbButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">250</span><span class="s1">)</span>
<span class="s1">nbButton.config(font=font1)</span>

<span class="s1">treeButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Run Ember Decision Tree Algorithm&quot;</span><span class="s0">, </span><span class="s1">command=decisionTree)</span>
<span class="s1">treeButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">300</span><span class="s1">)</span>
<span class="s1">treeButton.config(font=font1)</span>

<span class="s1">lrButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Run Ember Logistic Regression Algorithm&quot;</span><span class="s0">, </span><span class="s1">command=logisticRegression)</span>
<span class="s1">lrButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">350</span><span class="s1">)</span>
<span class="s1">lrButton.config(font=font1)</span>


<span class="s1">cnnButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Run MalConv CNN&quot;</span><span class="s0">, </span><span class="s1">command=CNN)</span>
<span class="s1">cnnButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">400</span><span class="s1">)</span>
<span class="s1">cnnButton.config(font=font1)</span>

<span class="s1">graphButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Precision Graph&quot;</span><span class="s0">, </span><span class="s1">command=precisionGraph)</span>
<span class="s1">graphButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">450</span><span class="s1">)</span>
<span class="s1">graphButton.config(font=font1)</span>

<span class="s1">recallButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Recall Graph&quot;</span><span class="s0">, </span><span class="s1">command=recallGraph)</span>
<span class="s1">recallButton.place(x=</span><span class="s4">900</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">450</span><span class="s1">)</span>
<span class="s1">recallButton.config(font=font1)</span>

<span class="s1">scoreButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Fscore Graph&quot;</span><span class="s0">, </span><span class="s1">command=fscoreGraph)</span>
<span class="s1">scoreButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">500</span><span class="s1">)</span>
<span class="s1">scoreButton.config(font=font1)</span>

<span class="s1">accButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Accuracy Graph&quot;</span><span class="s0">, </span><span class="s1">command=accuracyGraph)</span>
<span class="s1">accButton.place(x=</span><span class="s4">900</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">500</span><span class="s1">)</span>
<span class="s1">accButton.config(font=font1)</span>

<span class="s1">predictButton = Button(main</span><span class="s0">, </span><span class="s1">text=</span><span class="s3">&quot;Predict Malware Family&quot;</span><span class="s0">, </span><span class="s1">command=predict)</span>
<span class="s1">predictButton.place(x=</span><span class="s4">700</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">550</span><span class="s1">)</span>
<span class="s1">predictButton.config(font=font1)</span>

<span class="s1">font1 = (</span><span class="s3">'times'</span><span class="s0">, </span><span class="s4">12</span><span class="s0">, </span><span class="s3">'bold'</span><span class="s1">)</span>
<span class="s1">text = Text(main</span><span class="s0">, </span><span class="s1">height=</span><span class="s4">30</span><span class="s0">, </span><span class="s1">width=</span><span class="s4">80</span><span class="s1">)</span>
<span class="s1">scroll = Scrollbar(text)</span>
<span class="s1">text.configure(yscrollcommand=scroll.set)</span>
<span class="s1">text.place(x=</span><span class="s4">10</span><span class="s0">, </span><span class="s1">y=</span><span class="s4">100</span><span class="s1">)</span>
<span class="s1">text.config(font=font1)</span>

<span class="s1">main.config(bg=</span><span class="s3">'gray87'</span><span class="s1">)</span>
<span class="s1">main.mainloop()</span>
</pre>
</body>
</html>